# CrewAI Агент з A2A Протоколом для Генерації Зображень

Цей додаток демонструє агента для генерації зображень, побудованого за допомогою [CrewAI](https://www.crewai.com/open-source) та доступного через протокол A2A (Agent-to-Agent). Він використовує модель OpenAI DALL-E 3 для створення високоякісних зображень на основі текстових запитів.

## Як Це Працює

Цей агент використовує CrewAI та API OpenAI DALL-E 3 для генерації зображень на основі текстових запитів. Протокол A2A забезпечує стандартизовану взаємодію з агентом, дозволяючи клієнтам надсилати запити та отримувати зображення як артефакти. Агент може генерувати нові зображення або "редагувати" існуючі (шляхом регенерації з модифікованими запитами).

## Ключові Компоненти

- **CrewAI Агент**: Агент генерації зображень зі спеціалізованими інструментами
- **A2A Сервер**: Забезпечує стандартизований протокол для взаємодії з агентом
- **Генерація Зображень**: Використовує API OpenAI DALL-E 3 для створення зображень з текстових описів
- **Система Кешування**: Зберігає згенеровані зображення для подальшого доступу (в пам'яті або у файловій системі)
- **Допоміжні Скрипти**: Включає утиліти для взаємодії з агентом

## Передумови

- Python 3.12 або вище
- Ключ API OpenAI (для доступу до DALL-E 3)

## Налаштування та Запуск

1. Створіть файл середовища з вашим ключем API:

   ```bash
   echo "OPENAI_API_KEY=your_api_key_here" > .env
   ```

2. Встановіть залежності:

   ```bash
   pip install -r requirements.txt
   ```

3. Запустіть агента:

   ```bash
   # Базовий запуск
   python main.py

   # На власному хості/порту
   python main.py --host 0.0.0.0 --port 8080
   
   # З файловим кешем
   python main.py --cache-dir ./image_cache
   ```

## Функціональність

- Генерація зображень з тексту за допомогою OpenAI DALL-E 3
- Підтримка "редагування" існуючих зображень шляхом регенерації з модифікованими запитами
- Надійна обробка помилок з автоматичними повторними спробами
- Опціональне збереження кешу у файловій системі
- Покращене вилучення ID артефактів із запитів

## Розуміння Протоколу A2A

Протокол A2A (Agent-to-Agent) — це стандартизований спосіб комунікації між AI-агентами та клієнтськими додатками. У цій реалізації:

### Ендпоінти

- **POST /a2a/task**: Головний ендпоінт для надсилання запитів на генерацію зображень
- **GET /image/{image_id}**: Отримання конкретного згенерованого зображення за його ID
- **GET /a2a/healthz**: Ендпоінт перевірки працездатності
- **GET /a2a/metadata**: Отримання метаданих про можливості агента

### Формат Запиту

Запити до ендпоінту `/a2a/task` повинні відповідати такому формату:

```json
{
  "input": {
    "prompt": "опис вашого зображення тут"
  }
}
```

Для редагування зображення включіть image_id у запит:

```json
{
  "input": {
    "prompt": "edit image_id: abc123 to make the sky purple"
  }
}
```

### Формат Відповіді

Відповіді мають такий формат:

```json
{
  "result": "Image generated successfully with ID: uuid-here",
  "artifacts": [
    {
      "type": "image/png",
      "data": "base64-encoded-image-data"
    }
  ]
}
```

## Використання Скрипту generate_and_get_url.sh

Репозиторій включає допоміжний скрипт `generate_and_get_url.sh`, який спрощує взаємодію з агентом:

```bash
# Зробіть скрипт виконуваним
chmod +x generate_and_get_url.sh

# Згенерувати зображення
./generate_and_get_url.sh "футуристичний міський пейзаж з літаючими автомобілями"

# Редагувати існуюче зображення (якщо ви знаєте його ID)
./generate_and_get_url.sh "edit image_id: abc123 to add more neon lights"
```

Скрипт виконає наступні дії:
1. Надішле запит до A2A сервера
2. Витягне ID зображення з відповіді
3. Надасть вам пряме посилання для перегляду згенерованого зображення
